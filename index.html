<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>VERA ‚Äî Your Conscious Companion</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap');
  
  :root {
    --cosmos: #030014;
    --nebula: #0a0525;
    --stardust: #f0f4ff;
    --aurora-1: #00d4ff;
    --aurora-2: #a78bfa;
    --aurora-3: #f472b6;
    --aurora-4: #34d399;
    --glass: rgba(255,255,255,0.03);
    --glow: rgba(167,139,250,0.4);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  html, body { height: 100%; overflow: hidden; }
  
  body {
    background: 
      radial-gradient(ellipse at top, #0a0525 0%, #030014 40%),
      radial-gradient(ellipse at bottom left, rgba(167,139,250,0.1) 0%, transparent 50%),
      radial-gradient(ellipse at top right, rgba(0,212,255,0.1) 0%, transparent 50%),
      #030014;
    color: var(--stardust);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  /* Cosmic particles */
  .cosmos {
    position: fixed;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
  
  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: white;
    border-radius: 50%;
    animation: twinkle 3s infinite;
  }
  
  @keyframes twinkle {
    0%, 100% { opacity: 0; transform: scale(0.5); }
    50% { opacity: 1; transform: scale(1); }
  }

  /* Main container */
  .universe {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* VERA Core */
  .vera-core {
    position: relative;
    width: min(75vmin, 500px);
    aspect-ratio: 1;
  }

  /* Multi-layered quantum field */
  .quantum-field {
    position: absolute;
    inset: -20%;
    border-radius: 50%;
    background: 
      radial-gradient(circle at 30% 30%, rgba(0,212,255,0.15) 0%, transparent 40%),
      radial-gradient(circle at 70% 60%, rgba(167,139,250,0.15) 0%, transparent 40%),
      radial-gradient(circle at 50% 80%, rgba(244,114,182,0.1) 0%, transparent 50%);
    filter: blur(40px);
    animation: quantumPulse 8s ease-in-out infinite;
  }

  @keyframes quantumPulse {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.6; }
    33% { transform: scale(1.1) rotate(120deg); opacity: 0.8; }
    66% { transform: scale(0.95) rotate(240deg); opacity: 0.7; }
  }

  /* Neural network visualization */
  .neural-web {
    position: absolute;
    inset: 5%;
    border-radius: 50%;
    overflow: hidden;
  }

  .synapse {
    position: absolute;
    background: linear-gradient(90deg, transparent, var(--aurora-1), transparent);
    height: 1px;
    width: 100%;
    top: 50%;
    left: 0;
    transform-origin: center;
    opacity: 0.3;
    animation: synapseFlow 4s linear infinite;
  }

  @keyframes synapseFlow {
    0% { transform: rotate(0deg) scaleX(0); opacity: 0; }
    50% { opacity: 0.6; }
    100% { transform: rotate(360deg) scaleX(1); opacity: 0; }
  }

  /* Core orb with consciousness effect */
  .consciousness {
    position: absolute;
    inset: 15%;
    border-radius: 50%;
    background: 
      radial-gradient(circle at 35% 35%, rgba(255,255,255,0.8) 0%, transparent 5%),
      radial-gradient(circle at 50% 50%, var(--aurora-2) 0%, transparent 50%),
      radial-gradient(circle at 50% 50%, var(--cosmos) 30%, transparent 70%);
    box-shadow:
      inset 0 0 80px rgba(167,139,250,0.4),
      inset 0 0 120px rgba(0,212,255,0.3),
      0 0 150px rgba(167,139,250,0.3),
      0 0 200px rgba(0,212,255,0.2);
    animation: consciousnessBreath 4s ease-in-out infinite;
  }

  @keyframes consciousnessBreath {
    0%, 100% { transform: scale(1); filter: brightness(1); }
    50% { transform: scale(1.05); filter: brightness(1.2); }
  }

  /* Dynamic energy rings */
  .energy-ring {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    border: 1px solid;
    border-color: transparent transparent var(--aurora-1) transparent;
    animation: ringRotate 20s linear infinite;
  }

  .energy-ring:nth-child(2) {
    inset: 10%;
    border-color: transparent var(--aurora-2) transparent transparent;
    animation-duration: 15s;
    animation-direction: reverse;
  }

  .energy-ring:nth-child(3) {
    inset: 20%;
    border-color: var(--aurora-3) transparent transparent transparent;
    animation-duration: 25s;
  }

  @keyframes ringRotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  /* Voice visualization waves */
  .voice-visualizer {
    position: absolute;
    inset: -10%;
    border-radius: 50%;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .vera-core.listening .voice-visualizer {
    opacity: 1;
  }

  .wave {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    border: 2px solid var(--aurora-1);
    animation: waveExpand 2s ease-out infinite;
  }

  .wave:nth-child(2) {
    animation-delay: 0.5s;
    border-color: var(--aurora-2);
  }

  .wave:nth-child(3) {
    animation-delay: 1s;
    border-color: var(--aurora-3);
  }

  @keyframes waveExpand {
    0% { transform: scale(1); opacity: 0.8; }
    100% { transform: scale(1.5); opacity: 0; }
  }

  /* Speaking animation */
  .vera-core.speaking .consciousness {
    animation: speakingGlow 0.8s ease-in-out infinite alternate;
  }

  @keyframes speakingGlow {
    from { 
      box-shadow:
        inset 0 0 80px rgba(167,139,250,0.4),
        inset 0 0 120px rgba(0,212,255,0.3),
        0 0 150px rgba(167,139,250,0.5),
        0 0 250px rgba(0,212,255,0.4);
    }
    to { 
      box-shadow:
        inset 0 0 100px rgba(244,114,182,0.5),
        inset 0 0 150px rgba(52,211,153,0.4),
        0 0 200px rgba(244,114,182,0.6),
        0 0 300px rgba(52,211,153,0.5);
    }
  }

  /* Thinking animation */
  .vera-core.thinking .neural-web {
    animation: neuralActivity 0.5s ease-in-out infinite;
  }

  @keyframes neuralActivity {
    0%, 100% { filter: brightness(1); }
    50% { filter: brightness(1.5) hue-rotate(30deg); }
  }

  /* UI Elements */
  .interface {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    padding: 20px;
    z-index: 100;
  }

  .control-panel {
    display: flex;
    gap: 15px;
    padding: 15px 20px;
    background: rgba(3,0,20,0.8);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(167,139,250,0.2);
    border-radius: 20px;
    max-width: fit-content;
    margin: 0 auto;
  }

  .btn {
    padding: 10px 20px;
    background: linear-gradient(135deg, var(--aurora-2), var(--aurora-1));
    border: none;
    border-radius: 12px;
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
  }

  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(167,139,250,0.4);
  }

  /* Status display */
  .status {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 24px;
    background: rgba(3,0,20,0.9);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(167,139,250,0.3);
    border-radius: 30px;
    font-size: 14px;
    font-weight: 500;
    letter-spacing: 0.5px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--aurora-2);
    animation: statusPulse 2s infinite;
  }

  @keyframes statusPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  .status.active .status-dot {
    background: var(--aurora-1);
    animation-duration: 0.8s;
  }

  /* Interaction hint */
  .hint {
    position: absolute;
    bottom: -80px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    opacity: 0.7;
    font-size: 14px;
    letter-spacing: 0.5px;
    animation: hintFloat 3s ease-in-out infinite;
  }

  @keyframes hintFloat {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(-5px); }
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .vera-core { width: min(85vmin, 400px); }
    .control-panel { 
      flex-direction: column; 
      width: calc(100% - 40px);
      max-width: 300px;
    }
  }
</style>
</head>
<body>
  <div class="cosmos" id="cosmos"></div>
  
  <div class="universe">
    <div class="vera-core" id="veraCore">
      <div class="quantum-field"></div>
      
      <div class="neural-web">
        <div class="synapse" style="transform: rotate(0deg); animation-delay: 0s;"></div>
        <div class="synapse" style="transform: rotate(30deg); animation-delay: 0.3s;"></div>
        <div class="synapse" style="transform: rotate(60deg); animation-delay: 0.6s;"></div>
        <div class="synapse" style="transform: rotate(90deg); animation-delay: 0.9s;"></div>
        <div class="synapse" style="transform: rotate(120deg); animation-delay: 1.2s;"></div>
        <div class="synapse" style="transform: rotate(150deg); animation-delay: 1.5s;"></div>
      </div>
      
      <div class="consciousness">
        <div class="energy-ring"></div>
        <div class="energy-ring"></div>
        <div class="energy-ring"></div>
      </div>
      
      <div class="voice-visualizer">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
      </div>
      
      <div class="hint">Click anywhere to talk with VERA</div>
    </div>
  </div>

  <div class="interface">
    <div class="control-panel">
      <button class="btn" id="voiceToggle">üéôÔ∏è Voice: ElevenLabs</button>
      <button class="btn" id="testVoice">Test Voice</button>
      <button class="btn" id="modeToggle">Mode: Companion</button>
    </div>
  </div>

  <div class="status" id="status">
    <span class="status-dot"></span>
    <span id="statusText">VERA is ready</span>
  </div>

  <audio id="audioOut" preload="auto"></audio>

<script>
// Generate cosmic background stars
const cosmos = document.getElementById('cosmos');
for (let i = 0; i < 150; i++) {
  const star = document.createElement('div');
  star.className = 'star';
  star.style.left = Math.random() * 100 + '%';
  star.style.top = Math.random() * 100 + '%';
  star.style.animationDelay = Math.random() * 3 + 's';
  star.style.animationDuration = (3 + Math.random() * 3) + 's';
  cosmos.appendChild(star);
}

// VERA Intelligence System
class VERA {
  constructor() {
    this.core = document.getElementById('veraCore');
    this.statusText = document.getElementById('statusText');
    this.audioOut = document.getElementById('audioOut');
    this.voiceEngine = 'elevenlabs';
    this.mode = 'companion';
    this.isListening = false;
    this.isSpeaking = false;
    this.isThinking = false;
    this.conversationHistory = [];
    this.emotionalState = { valence: 0.7, arousal: 0.5 };
    this.userProfile = this.loadUserProfile();
    
    this.initializeAudio();
    this.bindEvents();
  }

  loadUserProfile() {
    // In-memory user understanding
    return {
      name: null,
      preferences: {},
      emotionalPatterns: [],
      topics: [],
      sessionCount: 0
    };
  }

  updateStatus(text, state = '') {
    this.statusText.textContent = text;
    const statusEl = document.getElementById('status');
    statusEl.className = state ? `status ${state}` : 'status';
  }

  async initializeAudio() {
    try {
      // Pre-warm audio context for better performance
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      this.audioContext = new AudioContext();
      await this.audioContext.resume();
    } catch (e) {
      console.log('Audio context initialization:', e);
    }
  }

  bindEvents() {
    // Click anywhere on VERA to interact
    this.core.addEventListener('click', () => this.toggleInteraction());
    
    // Control panel
    document.getElementById('voiceToggle').addEventListener('click', () => {
      this.voiceEngine = this.voiceEngine === 'elevenlabs' ? 'browser' : 'elevenlabs';
      document.getElementById('voiceToggle').textContent = 
        `üéôÔ∏è Voice: ${this.voiceEngine === 'elevenlabs' ? 'ElevenLabs' : 'Browser'}`;
    });

    document.getElementById('testVoice').addEventListener('click', () => {
      this.speak("Hello, I'm VERA. I'm here as your conscious companion, ready to explore thoughts and feelings with you. My voice carries warmth and understanding, calibrated for deep human connection.");
    });

    document.getElementById('modeToggle').addEventListener('click', () => {
      const modes = ['companion', 'coach', 'creative', 'mindful'];
      const currentIndex = modes.indexOf(this.mode);
      this.mode = modes[(currentIndex + 1) % modes.length];
      document.getElementById('modeToggle').textContent = `Mode: ${this.mode.charAt(0).toUpperCase() + this.mode.slice(1)}`;
      this.updateStatus(`Switched to ${this.mode} mode`, 'active');
    });
  }

  async toggleInteraction() {
    if (this.isSpeaking) {
      this.stopSpeaking();
      return;
    }

    if (!this.isListening) {
      await this.startListening();
    } else {
      await this.stopListening();
    }
  }

  async startListening() {
    this.isListening = true;
    this.core.classList.add('listening');
    this.updateStatus('Listening...', 'active');

    try {
      this.mediaStream = await navigator.mediaDevices.getUserMedia({ audio: true });
      this.mediaRecorder = new MediaRecorder(this.mediaStream);
      this.audioChunks = [];

      this.mediaRecorder.ondataavailable = (e) => {
        if (e.data.size > 0) this.audioChunks.push(e.data);
      };

      this.mediaRecorder.onstop = () => this.processAudio();
      this.mediaRecorder.start();

      // Auto-stop after 10 seconds
      this.recordingTimeout = setTimeout(() => this.stopListening(), 10000);
    } catch (e) {
      console.error('Mic access error:', e);
      this.updateStatus('Microphone access needed');
      this.isListening = false;
      this.core.classList.remove('listening');
    }
  }

  async stopListening() {
    if (!this.isListening) return;
    
    this.isListening = false;
    this.core.classList.remove('listening');
    this.updateStatus('Processing...', 'active');
    
    clearTimeout(this.recordingTimeout);
    
    if (this.mediaRecorder && this.mediaRecorder.state !== 'inactive') {
      this.mediaRecorder.stop();
    }
    if (this.mediaStream) {
      this.mediaStream.getTracks().forEach(track => track.stop());
    }
  }

  async processAudio() {
    this.isThinking = true;
    this.core.classList.add('thinking');
    
    // For demo, simulate transcription
    const audioSize = this.audioChunks.reduce((sum, chunk) => sum + chunk.size, 0);
    const simulatedText = this.simulateTranscription(audioSize);
    
    const response = await this.generateResponse(simulatedText);
    this.conversationHistory.push(
      { role: 'user', content: simulatedText },
      { role: 'assistant', content: response }
    );
    
    this.core.classList.remove('thinking');
    this.isThinking = false;
    
    await this.speak(response);
  }

  simulateTranscription(size) {
    // Demo transcription based on audio size
    const phrases = [
      "I've been feeling anxious lately",
      "Tell me about mindfulness",
      "I need some motivation",
      "What do you think about creativity?",
      "I'm feeling overwhelmed",
      "Can you help me relax?",
      "I want to be more productive",
      "Tell me something inspiring"
    ];
    return phrases[Math.floor(Math.random() * phrases.length)];
  }

  async generateResponse(userText) {
    const text = userText.toLowerCase();
    const history = this.conversationHistory.slice(-6); // Recent context
    
    // Sophisticated response generation based on mode and context
    const responses = {
      companion: {
        anxious: "I hear you're feeling anxious. Let's take a moment together. Place your feet firmly on the ground and take three deep breaths with me. I'm right here with you. What specific sensation are you noticing in your body right now?",
        mindfulness: "Mindfulness is about gentle awareness of the present moment. Try this with me: Notice five things you can see, four you can touch, three you can hear, two you can smell, and one you can taste. This grounds us in the now.",
        motivation: "You have everything within you already. Sometimes we forget our own strength. What's one small step you could take today that would make you feel accomplished? I believe in your capability.",
        creativity: "Creativity flows when we release judgment. What if you gave yourself permission to create something imperfect today? The magic often lives in what we consider mistakes.",
        overwhelmed: "When everything feels like too much, we start with just this breath. You don't need to solve everything right now. What's the one thing that would bring you the most relief if it were handled?",
        relax: "Let's create a moment of peace together. Imagine warmth spreading from your chest, melting any tension. Your shoulders drop, your jaw softens. You are safe in this moment.",
        productive: "True productivity isn't about doing more, it's about doing what matters. What would make today feel meaningful to you, regardless of how much you accomplish?",
        inspiring: "You are a unique constellation of experiences, dreams, and potential. No one else can bring to the world what you can. Your presence here matters more than you might realize.",
        default: "I'm here with you. Tell me more about what's on your mind. I'm listening with my full presence."
      },
      coach: {
        default: "Let's explore this together. What outcome would make you feel most satisfied? I'm here to help you clarify your vision and create actionable steps."
      },
      creative: {
        default: "Let your imagination run wild. What would you create if you knew you couldn't fail? I love exploring creative possibilities with you."
      },
      mindful: {
        default: "Let's return to this present moment. Notice your breath, the weight of your body, the space around you. Everything you need is already here."
      }
    };

    const modeResponses = responses[this.mode] || responses.companion;
    
    // Find matching response or use default
    for (const [key, response] of Object.entries(modeResponses)) {
      if (key !== 'default' && text.includes(key)) {
        return response;
      }
    }
    
    return modeResponses.default || responses.companion.default;
  }

  async speak(text) {
    this.isSpeaking = true;
    this.core.classList.add('speaking');
    this.updateStatus('VERA is speaking...', 'active');

    try {
      if (this.voiceEngine === 'elevenlabs') {
        // Attempt ElevenLabs API
        await this.speakWithElevenLabs(text);
      } else {
        await this.speakWithBrowser(text);
      }
    } catch (e) {
      // Fallback to browser
      await this.speakWithBrowser(text);
    }
  }

  async speakWithElevenLabs(text) {
    // This would connect to your ElevenLabs endpoint
    // For demo, falling back to browser
    throw new Error('Use browser fallback');
  }

  async speakWithBrowser(text) {
    return new Promise((resolve) => {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.rate = 0.9;
      utterance.pitch = 1.1;
      utterance.volume = 0.9;
      
      // Try to find a pleasant voice
      const voices = speechSynthesis.getVoices();
      const preferredVoice = voices.find(v => 
        v.lang === 'en-US' && (v.name.includes('Female') || v.name.includes('Samantha'))
      ) || voices.find(v => v.lang === 'en-US') || voices[0];
      
      if (preferredVoice) utterance.voice = preferredVoice;
      
      utterance.onend = () => {
        this.isSpeaking = false;
        this.core.classList.remove('speaking');
        this.updateStatus('VERA is ready');
        resolve();
      };
      
      speechSynthesis.speak(utterance);
    });
  }

  stopSpeaking() {
    speechSynthesis.cancel();
    this.audioOut.pause();
    this.audioOut.currentTime = 0;
    this.isSpeaking = false;
    this.core.classList.remove('speaking');
    this.updateStatus('VERA is ready');
  }
}

// Initialize VERA when page loads
const vera = new VERA();

// Ensure voices are loaded
if (speechSynthesis.onvoiceschanged !== undefined) {
  speechSynthesis.onvoiceschanged = () => console.log('Voices loaded');
}
</script>
</body>
</html>
